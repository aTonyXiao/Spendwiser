<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/components/cards/YourCards.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav class="nav">
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="Account.html">Account</a></li></ul><h3>Modules</h3><ul><li><a href="module-AddCardDB.html">AddCardDB</a></li><li><a href="module-AddCardManual.html">AddCardManual</a></li><li><a href="module-AddCardModal.html">AddCardModal</a></li><li><a href="module-App.html">App</a></li><li><a href="module-BackButtonHeader.html">BackButtonHeader</a></li><li><a href="module-CameraSettingsBar.html">CameraSettingsBar</a></li><li><a href="module-Card.html">Card</a></li><li><a href="module-CardImage.html">CardImage</a></li><li><a href="module-CardSelect.html">CardSelect</a></li><li><a href="module-ChooseImage.html">ChooseImage</a></li><li><a href="module-DisplayCard.html">DisplayCard</a></li><li><a href="module-DoubleTap.html">DoubleTap</a></li><li><a href="module-EditImage.html">EditImage</a></li><li><a href="module-EditTransactionModal.html">EditTransactionModal</a></li><li><a href="module-Footer.html">Footer</a></li><li><a href="module-HelpModal.html">HelpModal</a></li><li><a href="module-LoadingScreen.html">LoadingScreen</a></li><li><a href="module-MainScreen.html">MainScreen</a><ul class='methods'><li data-type='method'><a href="module-MainScreen.html#~addManualInput">addManualInput</a></li><li data-type='method'><a href="module-MainScreen.html#~backAction">backAction</a></li><li data-type='method'><a href="module-MainScreen.html#~getDisabledCards">getDisabledCards</a></li><li data-type='method'><a href="module-MainScreen.html#~getLocationFromAPI">getLocationFromAPI</a></li><li data-type='method'><a href="module-MainScreen.html#~getRecCardFromDB">getRecCardFromDB</a></li><li data-type='method'><a href="module-MainScreen.html#~onBottomSheetLayout">onBottomSheetLayout</a></li><li data-type='method'><a href="module-MainScreen.html#~reloadRecCard">reloadRecCard</a></li><li data-type='method'><a href="module-MainScreen.html#~setLocationDisabledMode">setLocationDisabledMode</a></li><li data-type='method'><a href="module-MainScreen.html#~setOfflineMode">setOfflineMode</a></li><li data-type='method'><a href="module-MainScreen.html#~switchStoresFromPOI">switchStoresFromPOI</a></li><li data-type='method'><a href="module-MainScreen.html#~tryToGetStoresFromLocation">tryToGetStoresFromLocation</a></li></ul></li><li><a href="module-MoveableBlock.html">MoveableBlock</a></li><li><a href="module-SpendingSummary.html">SpendingSummary</a><ul class='methods'><li data-type='method'><a href="module-SpendingSummary.html#~changeCategoriesLimit">changeCategoriesLimit</a></li><li data-type='method'><a href="module-SpendingSummary.html#~changeCategory">changeCategory</a></li><li data-type='method'><a href="module-SpendingSummary.html#~getCardFromDB">getCardFromDB</a></li><li data-type='method'><a href="module-SpendingSummary.html#~getCompareTimeFrameTransactions">getCompareTimeFrameTransactions</a></li><li data-type='method'><a href="module-SpendingSummary.html#~processTransaction">processTransaction</a></li><li data-type='method'><a href="module-SpendingSummary.html#~setCurCardFromModal">setCurCardFromModal</a></li><li data-type='method'><a href="module-SpendingSummary.html#~setNewPeriod">setNewPeriod</a></li></ul></li><li><a href="module-Textbox.html">Textbox</a></li><li><a href="module-YourCards.html">YourCards</a></li></ul><h3>Classes</h3><ul><li><a href="AppleLogin.html">AppleLogin</a></li><li><a href="BaseBackend.html">BaseBackend</a><ul class='methods'><li data-type='method'><a href="BaseBackend.html#dbAdd">dbAdd</a></li><li data-type='method'><a href="BaseBackend.html#dbAddEncrypted">dbAddEncrypted</a></li><li data-type='method'><a href="BaseBackend.html#dbDelete">dbDelete</a></li><li data-type='method'><a href="BaseBackend.html#dbDoesDocExist">dbDoesDocExist</a></li><li data-type='method'><a href="BaseBackend.html#dbGet">dbGet</a></li><li data-type='method'><a href="BaseBackend.html#dbGetEncrypted">dbGetEncrypted</a></li><li data-type='method'><a href="BaseBackend.html#dbGetSubCollections">dbGetSubCollections</a></li><li data-type='method'><a href="BaseBackend.html#dbSet">dbSet</a></li><li data-type='method'><a href="BaseBackend.html#dbSetEncrypted">dbSetEncrypted</a></li><li data-type='method'><a href="BaseBackend.html#doesSupportDatabase">doesSupportDatabase</a></li><li data-type='method'><a href="BaseBackend.html#enableDatabaseCaching">enableDatabaseCaching</a></li><li data-type='method'><a href="BaseBackend.html#getLoginProviders">getLoginProviders</a></li><li data-type='method'><a href="BaseBackend.html#getTimestamp">getTimestamp</a></li><li data-type='method'><a href="BaseBackend.html#getUserID">getUserID</a></li><li data-type='method'><a href="BaseBackend.html#getUserInfo">getUserInfo</a></li><li data-type='method'><a href="BaseBackend.html#initializeApp">initializeApp</a></li><li data-type='method'><a href="BaseBackend.html#onAuthStateChange">onAuthStateChange</a></li><li data-type='method'><a href="BaseBackend.html#resetPassword">resetPassword</a></li><li data-type='method'><a href="BaseBackend.html#setPrivateKey">setPrivateKey</a></li><li data-type='method'><a href="BaseBackend.html#signIn">signIn</a></li><li data-type='method'><a href="BaseBackend.html#signInOffline">signInOffline</a></li><li data-type='method'><a href="BaseBackend.html#signOut">signOut</a></li><li data-type='method'><a href="BaseBackend.html#signUp">signUp</a></li><li data-type='method'><a href="BaseBackend.html#userAccountType">userAccountType</a></li><li data-type='method'><a href="BaseBackend.html#userLoggedIn">userLoggedIn</a></li></ul></li><li><a href="Cards.html">Cards</a><ul class='methods'><li data-type='method'><a href="Cards.html#addCardToDatabase">addCardToDatabase</a></li><li data-type='method'><a href="Cards.html#addJsonToDatabase">addJsonToDatabase</a></li><li data-type='method'><a href="Cards.html#getCardData">getCardData</a></li><li data-type='method'><a href="Cards.html#getCardImageURL">getCardImageURL</a></li><li data-type='method'><a href="Cards.html#getCardImg">getCardImg</a></li><li data-type='method'><a href="Cards.html#getCardName">getCardName</a></li><li data-type='method'><a href="Cards.html#getCardNames">getCardNames</a></li><li data-type='method'><a href="Cards.html#getCardReward">getCardReward</a></li></ul></li><li><a href="FacebookLogin.html">FacebookLogin</a></li><li><a href="FirebaseBackend.html">FirebaseBackend</a><ul class='methods'><li data-type='method'><a href="FirebaseBackend.html#dbAdd">dbAdd</a></li><li data-type='method'><a href="FirebaseBackend.html#dbDelete">dbDelete</a></li><li data-type='method'><a href="FirebaseBackend.html#dbDoesDocExist">dbDoesDocExist</a></li><li data-type='method'><a href="FirebaseBackend.html#dbGet">dbGet</a></li><li data-type='method'><a href="FirebaseBackend.html#dbGetSubCollections">dbGetSubCollections</a></li><li data-type='method'><a href="FirebaseBackend.html#dbGetSubCollectionsRemote">dbGetSubCollectionsRemote</a></li><li data-type='method'><a href="FirebaseBackend.html#dbSet">dbSet</a></li><li data-type='method'><a href="FirebaseBackend.html#doesSupportDatabase">doesSupportDatabase</a></li><li data-type='method'><a href="FirebaseBackend.html#enableDatabaseCaching">enableDatabaseCaching</a></li><li data-type='method'><a href="FirebaseBackend.html#getLoginProviders">getLoginProviders</a></li><li data-type='method'><a href="FirebaseBackend.html#getTimestamp">getTimestamp</a></li><li data-type='method'><a href="FirebaseBackend.html#getUserID">getUserID</a></li><li data-type='method'><a href="FirebaseBackend.html#getUserInfo">getUserInfo</a></li><li data-type='method'><a href="FirebaseBackend.html#initializeApp">initializeApp</a></li><li data-type='method'><a href="FirebaseBackend.html#onAuthStateChange">onAuthStateChange</a></li><li data-type='method'><a href="FirebaseBackend.html#remoteDBAdd">remoteDBAdd</a></li><li data-type='method'><a href="FirebaseBackend.html#remoteDBDelete">remoteDBDelete</a></li><li data-type='method'><a href="FirebaseBackend.html#remoteDBGet">remoteDBGet</a></li><li data-type='method'><a href="FirebaseBackend.html#remoteDBSet">remoteDBSet</a></li><li data-type='method'><a href="FirebaseBackend.html#resetPassword">resetPassword</a></li><li data-type='method'><a href="FirebaseBackend.html#signIn">signIn</a></li><li data-type='method'><a href="FirebaseBackend.html#signInOffline">signInOffline</a></li><li data-type='method'><a href="FirebaseBackend.html#signOut">signOut</a></li><li data-type='method'><a href="FirebaseBackend.html#signUp">signUp</a></li><li data-type='method'><a href="FirebaseBackend.html#userAccountType">userAccountType</a></li><li data-type='method'><a href="FirebaseBackend.html#userLoggedIn">userLoggedIn</a></li></ul></li><li><a href="GoogleLogin.html">GoogleLogin</a></li><li><a href="LoginAuthorizer.html">LoginAuthorizer</a><ul class='methods'><li data-type='method'><a href="LoginAuthorizer.html#login">login</a></li></ul></li><li><a href="RecommendCard.html">RecommendCard</a><ul class='methods'><li data-type='method'><a href="RecommendCard.html#getCategory">getCategory</a></li><li data-type='method'><a href="RecommendCard.html#getRecCards">getRecCards</a></li></ul></li><li><a href="ServerBackend.html">ServerBackend</a><ul class='methods'><li data-type='method'><a href="ServerBackend.html#dbAdd">dbAdd</a></li><li data-type='method'><a href="ServerBackend.html#dbDelete">dbDelete</a></li><li data-type='method'><a href="ServerBackend.html#dbDoesDocExist">dbDoesDocExist</a></li><li data-type='method'><a href="ServerBackend.html#dbGet">dbGet</a></li><li data-type='method'><a href="ServerBackend.html#dbGetSubCollections">dbGetSubCollections</a></li><li data-type='method'><a href="ServerBackend.html#dbGetSubCollectionsRemote">dbGetSubCollectionsRemote</a></li><li data-type='method'><a href="ServerBackend.html#dbSet">dbSet</a></li><li data-type='method'><a href="ServerBackend.html#doesSupportDatabase">doesSupportDatabase</a></li><li data-type='method'><a href="ServerBackend.html#enableDatabaseCaching">enableDatabaseCaching</a></li><li data-type='method'><a href="ServerBackend.html#getLoginProviders">getLoginProviders</a></li><li data-type='method'><a href="ServerBackend.html#getTimestamp">getTimestamp</a></li><li data-type='method'><a href="ServerBackend.html#getUserID">getUserID</a></li><li data-type='method'><a href="ServerBackend.html#getUserInfo">getUserInfo</a></li><li data-type='method'><a href="ServerBackend.html#getUserToken">getUserToken</a></li><li data-type='method'><a href="ServerBackend.html#initializeApp">initializeApp</a></li><li data-type='method'><a href="ServerBackend.html#onAuthStateChange">onAuthStateChange</a></li><li data-type='method'><a href="ServerBackend.html#remoteDBAdd">remoteDBAdd</a></li><li data-type='method'><a href="ServerBackend.html#remoteDBDelete">remoteDBDelete</a></li><li data-type='method'><a href="ServerBackend.html#remoteDBGet">remoteDBGet</a></li><li data-type='method'><a href="ServerBackend.html#remoteDBSet">remoteDBSet</a></li><li data-type='method'><a href="ServerBackend.html#resetPassword">resetPassword</a></li><li data-type='method'><a href="ServerBackend.html#signIn">signIn</a></li><li data-type='method'><a href="ServerBackend.html#signInOffline">signInOffline</a></li><li data-type='method'><a href="ServerBackend.html#signOut">signOut</a></li><li data-type='method'><a href="ServerBackend.html#signUp">signUp</a></li><li data-type='method'><a href="ServerBackend.html#userAccountType">userAccountType</a></li><li data-type='method'><a href="ServerBackend.html#userLoggedIn">userLoggedIn</a></li></ul></li><li><a href="SummaryHelper.html">SummaryHelper</a><ul class='methods'><li data-type='method'><a href="SummaryHelper.html#addSortedNewTransaction">addSortedNewTransaction</a></li><li data-type='method'><a href="SummaryHelper.html#getDbCards">getDbCards</a></li><li data-type='method'><a href="SummaryHelper.html#getTimeFrame">getTimeFrame</a></li><li data-type='method'><a href="SummaryHelper.html#matchTransactionToCategory">matchTransactionToCategory</a></li></ul></li><li><a href="userClass.html">userClass</a><ul class='methods'><li data-type='method'><a href="userClass.html#addTransactionId">addTransactionId</a></li><li data-type='method'><a href="userClass.html#addUser">addUser</a></li><li data-type='method'><a href="userClass.html#deleteCard">deleteCard</a></li><li data-type='method'><a href="userClass.html#deleteTransaction">deleteTransaction</a></li><li data-type='method'><a href="userClass.html#editTransaction">editTransaction</a></li><li data-type='method'><a href="userClass.html#getAllTransactions">getAllTransactions</a></li><li data-type='method'><a href="userClass.html#getCardDocId">getCardDocId</a></li><li data-type='method'><a href="userClass.html#getCards">getCards</a></li><li data-type='method'><a href="userClass.html#getMainNeedsUpdate">getMainNeedsUpdate</a></li><li data-type='method'><a href="userClass.html#getRewards">getRewards</a></li><li data-type='method'><a href="userClass.html#getTimeFrameTransactions">getTimeFrameTransactions</a></li><li data-type='method'><a href="userClass.html#getTransactionsForCard">getTransactionsForCard</a></li><li data-type='method'><a href="userClass.html#getUserId">getUserId</a></li><li data-type='method'><a href="userClass.html#saveCardToUser">saveCardToUser</a></li><li data-type='method'><a href="userClass.html#saveTransaction">saveTransaction</a></li><li data-type='method'><a href="userClass.html#setMainNeedsUpdate">setMainNeedsUpdate</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">src/components/cards/YourCards.js</h1>
    

    <!--container.tmpl-->




    <!--source.tmpl-->

    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React from 'react';
import {
    StyleSheet, 
    View, 
    Text, 
    TouchableOpacity,
    Alert,
    Animated,
    Dimensions,
    PixelRatio,
    SafeAreaView
} from 'react-native';
import { Card } from './Card';
import { user } from '../../network/user';
import { useState, useRef, useEffect } from "react";
import { Ionicons } from '@expo/vector-icons';
import { Footer } from '../util/Footer';
import { AddCardModal } from './AddCardModal';
import { useIsFocused, StackActions } from '@react-navigation/native';
import { makeCancelable } from '../util/promise-helper';
import { SwipeListView } from 'react-native-swipe-list-view';
import mainStyles from "../../styles/mainStyles"
import * as Haptics from 'expo-haptics';
import * as storage from '../../local/storage';

// the card height found using a ratio
const CARD_HEIGHT = (Dimensions.get('window').width * 0.9) / 1.586;

/**
 * Display all of the credit cards associated with a user's account in a scrollable and selectable view. 
 * Shows each credit card's name and a picture of the card. If not card image is found, a gradient/colorized
 * image will be displayed instead.
 * 
 * @param {{Object, Object}} obj - The route and navigation passed directly to display card
 * @param {Object} obj.route - routing object containing information about a specific store
 * @param {Object} obj.navigation - navigation object used to move between different pages
 * @module YourCards
 */
function YourCards({ route, navigation }) {
    const [cards, setCards] = useState([]); // the current cards list
    const [swipeDeleteWidths, setSwipeDeleteWidths] = useState({}); // the swipe button widths (for delete)
    const [swipeLockWidths, setSwipeLockWidths] = useState({}); // the swipe button widths (for lock)
    const [swipeHeights, setSwipeHeights] = useState({}); // the swipe button heights
    const [swipeOpacities, setSwipeOpacities] = useState({}); // the card opacities (for swipe)
    const rowRefs = useRef({}); // the row references for swipeable cards
    const [isLoaded, setLoaded] = useState(false); // whether this page was loaded already or not
    const animationRunning = useRef(false); // whether there is an animation currently running
    const swipeButtonOpen = useRef(false); // whether a swipe button is currently open
    const userId = user.getUserId(); // get the user id
    const [modalVisible, setModalVisible] = useState(false);
    const storeInformation = route.params.storeInformation;
    const forceLoad = ((typeof route.params.forceLoad !== "undefined") &amp;&amp; (route.params.forceLoad === true));
    const focused = useIsFocused();
    const [cardToEnableDisable, setCardToEnableDisable] = useState(null);

    const resetAnimationValues = key => {
        if (typeof swipeDeleteWidths[key] === "undefined") { // if they don't exist, create them
            swipeDeleteWidths[key] = new Animated.Value(0);
            swipeLockWidths[key] = new Animated.Value(0);
            swipeHeights[key] = new Animated.Value(CARD_HEIGHT + 20 * PixelRatio.getFontScale() + 24);
            swipeOpacities[key] = new Animated.Value(1.0);
        } else { // set to their defaults if they do exist
            swipeDeleteWidths[key].setValue(0);
            swipeLockWidths[key].setValue(0);
            swipeHeights[key].setValue(CARD_HEIGHT + 20 * PixelRatio.getFontScale() + 24);
            swipeOpacities[key].setValue(1.0);
        }
    };

    // react native use effect for the 'OnFocus' action
    useEffect(() => {
        if (isLoaded === false || forceLoad === true) { // whether a force load or if not loaded yet
            // load the cards in
            const cancelableGetCards = makeCancelable(user.getCards(userId));
            cancelableGetCards.promise.then(cards => {
                setCards([]);
                cards.forEach(element => { // add a "key" for each for SwipeListView support
                    element["key"] = cards.indexOf(element).toString();
                    resetAnimationValues(element["key"]);
                });
                setCards(cards);
            }).catch(({isCanceled, ...error}) => {});
    
            setLoaded(true);
            route.params.forceLoad = false; // hacky

            return () => {
                cancelableGetCards.cancel();
            }
        }
    }, [focused])

    // delete card function with animation
    const deleteCard = (card, index) => {
        user.deleteCard(userId, card.cardId, card.docId); // delete from the user
        // animate the delete
        Animated.timing(swipeHeights[index], {
            toValue: 0,
            duration: 150,
            useNativeDriver: false
        }).start(() => {
            if (rowRefs.current[index.toString()] !== undefined) rowRefs.current[index.toString()].closeRow();
            let newCards = [...cards];
            for (let i = index; i &lt; newCards.length; i++) { // recalculate keys
                newCards[i]["key"] = (parseInt(newCards[i]["key"]) - 1).toString();
            }
            newCards.splice(index, 1);
            setCards(newCards);
            resetAnimationValues(index);
        });
    }

    // lock a card
    const lockCard = (card, index) => {
        if (card !== null) {
            // disable the card for the user
            storage.setDisabledCards(card.cardId);
            user.setMainNeedsUpdate(true);
            setTimeout(() => {
                if (rowRefs.current[index.toString()] !== undefined) rowRefs.current[index.toString()].closeRow();
                swipeOpacities[index.toString()].setValue(1.0);
            }, 150);
            setCardToEnableDisable(card.cardId);
        }
    }
    
    // confirmation for deletion using an Alert
    const confirmDelete = (card, index) => {
        Alert.alert(
            'Delete Card?',
            'This card will be permanently deleted from your profile.',
            [
              {text: 'Delete', onPress: () => deleteCard(card, index)},
              {text: 'Cancel', onPress: () => console.log(''), style: 'cancel'},
            ]
          );
    };

    // confirmation for when a swipe button is clicked
    const confirmSwipeAction = (card, index) => {
        // choose a swipe action depending on the width of the delete button
        if (swipeDeleteWidths[index].__getValue() === 0) lockCard(card, index);
        else confirmDelete(card, index);
    }

    // No cards, render empty
    if (cards.length == 0) {
        return (
            &lt;SafeAreaView style={mainStyles.screen}>
                &lt;View style={mainStyles.bodyContainer}>
                    &lt;AddCardModal
                        navigation={navigation}
                        modalVisible={modalVisible}
                        setModalVisible={setModalVisible}
                    />

                    &lt;View style={styles.addButton}>
                        &lt;TouchableOpacity onPress={() => setModalVisible(true)}>
                            &lt;Ionicons
                                name="add-circle-outline"
                                color="black"
                                size={32}
                            >&lt;/Ionicons>
                        &lt;/TouchableOpacity>
                    &lt;/View>

                    &lt;View style={styles.emptyBodyContainer}>
                    &lt;Text style={{ paddingTop: "50%", fontSize: 18 }}>No cards yet.&lt;/Text>
                    &lt;/View>
                &lt;/View>
                &lt;View style={styles.footerContainer}>
                    &lt;Footer navigation={navigation} />
                &lt;/View>
            &lt;/SafeAreaView>
        )
    }

    // calculate the swipe threshold to be 50% of the width of the screen
    const swipeThreshold = Dimensions.get('window').width * 0.5;
    const onSwipeValueChange = swipeData => {
        const { key, value } = swipeData;
        let deleteFlag = value &lt; 0; // flag for deletion (left swipe)
        // reset the widths if not visible
        if (deleteFlag) swipeLockWidths[key].setValue(0);
        else swipeDeleteWidths[key].setValue(0);
        if (Math.abs(value) > swipeThreshold) {
            if (!animationRunning.current &amp;&amp; !swipeButtonOpen.current) {
                // https://docs.expo.io/versions/latest/sdk/haptics/
                Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);
                // animate to hide the card
                Animated.timing(swipeOpacities[key], {
                    toValue: 0.0,
                    duration: 100,
                    useNativeDriver: false
                }).start();
                // animate to make the button in full view
                Animated.timing(deleteFlag ? swipeDeleteWidths[key] : swipeLockWidths[key], {
                    toValue: Dimensions.get('window').width * 0.9,
                    duration: 150,
                    useNativeDriver: false
                }).start(() => {
                    animationRunning.current = false;
                    swipeButtonOpen.current = true;
                    swipeOpacities[key].setValue(0.0);
                });
                animationRunning.current = true;
            }
        } else {
            if (!animationRunning.current &amp;&amp; swipeButtonOpen.current) {
                // https://docs.expo.io/versions/latest/sdk/haptics/
                Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);
                // animate to make card visible again
                Animated.timing(swipeOpacities[key], {
                    toValue: 1.0,
                    duration: 100,
                    useNativeDriver: false
                }).start();
                // spring back to what it was before
                Animated.timing(deleteFlag ? swipeDeleteWidths[key] : swipeLockWidths[key], {
                    toValue: Math.abs(value),
                    duration: 150,
                    useNativeDriver: false
                }).start(() => {
                    animationRunning.current = false;
                    swipeButtonOpen.current = false;
                    swipeOpacities[key].setValue(1.0);
                });
                animationRunning.current = true;
            } else if (!animationRunning.current) {
                // keep updating the width for smooth
                if (deleteFlag) swipeDeleteWidths[key].setValue(Math.abs(value));
                else swipeLockWidths[key].setValue(Math.abs(value));
            }
        }
    };

    const swipeGestureEnded = (key, data) => {
        // detect when past theswipe threshold
        if (Math.abs(data.translateX) > swipeThreshold) {
            let index = parseInt(key);
            if (data.translateX &lt; 0) deleteCard(cards[index], index);
            else lockCard(cards[index], index);
        }
    };

    const onRowOpen = (rowKey, rowMap) => {
        rowRefs.current[rowKey] = rowMap[rowKey]; // hacky update of the rowRefs
    };

    const onRowClose = (rowKey, rowMap) => {
        rowRefs.current[rowKey] = undefined; // hacky update of the rowRefs
    };

    // render the cards
    return (
        &lt;SafeAreaView style={mainStyles.screen}>
            &lt;View style={mainStyles.bodyContainer}>
                &lt;AddCardModal
                    navigation={navigation}
                    modalVisible={modalVisible}
                    setModalVisible={setModalVisible}
                />
                &lt;View style={styles.addButton}>
                    &lt;TouchableOpacity onPress={() => setModalVisible(true)}>
                        &lt;Ionicons
                            name="add-circle-outline"
                            color="black"
                            size={32}
                        >&lt;/Ionicons>
                    &lt;/TouchableOpacity>
                &lt;/View>

                &lt;View style={{flex: 1}}>
                    &lt;SwipeListView
                        data={cards}
                        renderItem={(data, rowMap) => (
                            &lt;View style={{paddingHorizontal: '5%'}}>
                                &lt;Animated.View key={data.item.docId} style={{ opacity: swipeOpacities[data.item.key], height: swipeHeights[data.item.key], overflow: "hidden" }}>
                                    &lt;Card
                                        key={data.item.docId}
                                        navigation={navigation}
                                        card={data.item}
                                        storeInformation={storeInformation}
                                        origin={"yourcards"}
                                        cardToEnableDisable = {cardToEnableDisable}
                                        setCardToEnableDisable = {setCardToEnableDisable}
                                    />
                                &lt;/Animated.View>
                                { /* render divider bar for all cards except for last card */ }
                                &lt;View style={data.item.key &lt; cards.length-1 ? styles.divider : [styles.divider, { opacity: 0 }]}>&lt;/View>
                            &lt;/View>
                        )}
                        renderHiddenItem={(data, rowMap) => (
                            &lt;Animated.View style={{ height: swipeHeights[data.item.key], overflow: "hidden" }}>
                                &lt;View style={styles.cardBackWrapper}>
                                    &lt;TouchableOpacity style={styles.cardBack} onPress={() => confirmSwipeAction(data.item, cards.indexOf(data.item))}>
                                        &lt;Animated.View style={[styles.cardDelete, { width: swipeDeleteWidths[data.item.key] }]}>
                                            &lt;Ionicons
                                                name="trash-outline"
                                                color="white"
                                                size={25}
                                            >&lt;/Ionicons>
                                        &lt;/Animated.View>
                                        &lt;Animated.View style={[styles.cardLock, { width: swipeLockWidths[data.item.key] }]}>
                                            &lt;Ionicons
                                                name="lock-closed-outline"
                                                color="white"
                                                size={25}
                                            >&lt;/Ionicons>
                                        &lt;/Animated.View>
                                    &lt;/TouchableOpacity>
                                &lt;/View>
                            &lt;/Animated.View>
                        )}
                        rightOpenValue={-100}
                        leftOpenValue={100}
                        onSwipeValueChange={onSwipeValueChange}
                        swipeGestureEnded={swipeGestureEnded}
                        onRowOpen={onRowOpen}
                        onRowClose={onRowClose}
                        useNativeDriver={false}
                    />
                &lt;/View>                
            &lt;/View>
            &lt;View style={[{shadowColor: "white", shadowOffset: { width: 0, height: -6 }, shadowOpacity: 1.0, shadowRadius: 3.00}, 
                          mainStyles.footerContainer]}>
                &lt;Footer navigation={navigation} />
            &lt;/View>
        &lt;/SafeAreaView>
    );
}

// the styles for this component
const styles = StyleSheet.create({
    emptyBodyContainer: {
        flex: 1,
        alignItems: "center"
    },
    addButton: {
        borderRadius: 100,
        paddingHorizontal: 5,
        alignSelf: 'flex-end',
        margin: 8,
        marginBottom: 0,
    },
    divider: { 
        width: '100%',
        borderWidth: 1,
        borderColor: 'lightgray',
        marginTop: 10
    },
    cardBackWrapper: {
        height: "100%",
        flexDirection: "row",
        paddingHorizontal: (Dimensions.get('window').width * 0.05),
    },
    cardBack: {
        width: "100%",
        height: CARD_HEIGHT,
        alignSelf: "flex-end",
        flexDirection: "row-reverse",
        justifyContent: "space-between"
    },
    cardDelete: {
        height: "100%",
        backgroundColor: 'red',
        alignItems: 'center',
        justifyContent: 'center',
        borderRadius: 15,
    },
    cardLock: {
        height: "100%",
        backgroundColor: 'orange',
        alignItems: 'center',
        justifyContent: 'center',
        borderRadius: 15,
    }
});

export { YourCards };</code></pre>
        </article>
    </section>





</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Thu Jun 03 2021 12:50:08 GMT-0700 (Pacific Daylight Time) using the LOKE theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
